c<-read.csv("rainfall.csv")
var<-read.csv("cloud_cover.csv")
library(dplyr)
library(TSA)
library(tseries)
head(c)
d=c
c<-filter(c,SD_Name=="EAST UTTAR PRADESH")
c<-filter(c,YEAR<=2001)
varc<-filter(var,YEAR<=2001)
vard<-filter(var,YEAR<=2002)
c<-select(c,YEAR:DEC)
varc<-select(varc,YEAR:DEC)
vard<-select(vard,YEAR:DEC)
#d<-filter(d,YEAR>2010)
d<-filter(d,SD_Name=="EAST UTTAR PRADESH")
d<-select(d,YEAR:DEC)
d<-filter(d,YEAR<=2002)
head(c)
library(reshape)
varmel<-melt(varc,c("YEAR"))
varmeld<-melt(vard,c("YEAR"))
mel<-melt(c,c("YEAR"))
meld<-melt(d,c("YEAR"))
head(mel)
varmel<-arrange(varmel,YEAR)
varmeld<-arrange(varmeld,YEAR)
mel<-arrange(mel,YEAR)
meld<-arrange(meld,YEAR)
head(mel)
mel<-ts(mel$value,frequency=12)
meld<-ts(meld$value,frequency=12)
#varmel<-ts(varmel$value,frequency=12)
#varmeld<-ts(varmeld$value,frequency=12)
class(mel)
#model<-arima(mel,order=c(1,0,1),seasonal=list(order=c(1,1,1),period=24))
#model_arimax<-Arima(mel,order=c(1,0,1),seasonal=list(order=c(1,1,1),period=12),xreg=varmel)
model<-arimax(mel,order=c(1,0,1),seasonal=list(order=c(1,1,1),period=12),xtransf=varmatrix)
#model1<-auto.arima(mel)
model_auto<-auto.arima(mel,xreg=varmel$value)
#summary(model)
#tail(model)
library(forecast)
pre = predict( model_auto, n.ahead = 12 , newxreg=varmatrix)
nrow(pre)
#pre<-forecast(model,h=12,xreg=varmel)
#plot(pre)
pre1<-as.data.frame(pre)
plot(pre1$pred,ylim=c(0,350))
lines(meld,col='red')
par(mfrow=c(1,1))